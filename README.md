# POS 收銀系統

## 專案簡介

這是一個基於 Web 的 POS（Point of Sale）收銀系統，提供完整的商品管理、購物車、訂單處理及管理員統計功能。系統採用前後端分離架構，使用 Flask 作為後端 API 伺服器，MySQL 作為資料庫。

## 技術架構

### 前端技術
- **HTML5** - 網頁結構
- **CSS3** - 樣式設計
- **JavaScript (ES6+)** - 前端邏輯與 API 互動

### 後端技術
- **Python 3** - 程式語言
- **Flask 3.0.0** - Web 框架
- **Flask-CORS 4.0.0** - 跨域資源共享支援
- **MySQL Connector Python 8.2.0** - MySQL 資料庫連接

### 資料庫
- **MySQL** - 關聯式資料庫（透過 XAMPP 運行）

## 系統功能

### 1. 用戶認證系統

### 1.0 預設管理員帳號
- **用戶名**：`admin`
- **密碼**：`admin123`

#### 1.1 用戶註冊
- 用戶名註冊（至少 3 個字符）
- 密碼設定（至少 6 個字符）
- 姓名設定（選填）
- 註冊後自動登入

#### 1.2 用戶登入/登出
- 用戶名與密碼登入
- Session 管理
- 登出功能

#### 1.3 帳號設定
- 修改用戶名
- 修改姓名
- 修改密碼（需輸入舊密碼驗證）
- 即時更新個人資料

#### 1.4 角色管理
- **普通用戶 (user)**：可瀏覽商品、購物、查看個人訂單
- **管理員 (admin)**：擁有所有功能，包含管理員統計

### 2. 商品管理

#### 2.1 商品瀏覽
- 商品列表展示（網格佈局）
- 顯示商品名稱、價格、庫存、描述
- 庫存不足提示（庫存 < 10 時顯示警告）

#### 2.2 商品搜尋
- 即時搜尋功能
- 根據商品名稱進行過濾

#### 2.3 商品管理（需登入）
- **新增商品**：設定商品名稱、價格、庫存、描述
- **編輯商品**：修改現有商品資訊
- **刪除商品**：移除商品（會同時刪除相關訂單項目）

### 3. 購物車功能

#### 3.1 購物車操作
- **添加商品**：點擊商品卡片加入購物車
- **調整數量**：增加/減少商品數量（受庫存限制）
- **移除商品**：從購物車中移除單一商品
- **清空購物車**：一鍵清除所有商品

#### 3.2 價格計算
- **小計**：所有商品價格總和
- **稅額**：自動計算 5% 營業稅
- **總計**：小計 + 稅額

#### 3.3 庫存檢查
- 添加商品時檢查庫存
- 防止超量購買
- 庫存不足時顯示提示

### 4. 訂單管理

#### 4.1 結帳功能（需登入）
- 確認購物車內容後結帳
- 自動更新商品庫存
- 生成訂單編號
- 交易完成後清空購物車

#### 4.2 訂單記錄
- 查看個人歷史訂單
- 顯示訂單編號、日期、商品明細、總金額
- 訂單按時間倒序排列

#### 4.3 訂單更改（需登入）
- 修改訂單中商品的數量
- 自動重新計算小計、稅額和總計
- 實時更新訂單金額
- 更改時自動檢查商品庫存
- 防止超量修改

#### 4.4 訂單刪除（需登入）
- 刪除個人訂單
- 刪除時自動恢復商品庫存
- 確認提示防止誤刪
- 已刪除訂單無法復原

### 5. 管理員統計功能（僅管理員可見）

#### 5.1 員工銷售數量統計
- 顯示每位員工的銷售總額
- 顯示每位員工的銷售商品總數
- 按銷售總額排序

#### 5.2 當日產品銷售統計
- 顯示當日各產品的銷售數量
- 顯示各產品的銷售總額
- 按銷售數量排序

#### 5.3 員工平均銷售統計
- 顯示每位員工的訂單數量
- 顯示平均訂單金額
- 顯示平均每單商品數量
- 按平均訂單金額排序

## 資料庫結構

### 資料表設計

#### users（用戶表）
- `id` - 主鍵
- `username` - 用戶名（唯一）
- `password` - 密碼（SHA256 雜湊）
- `name` - 姓名
- `role` - 角色（user/admin）
- `created_at` - 建立時間

#### products（商品表）
- `id` - 主鍵
- `name` - 商品名稱
- `price` - 價格
- `stock` - 庫存
- `description` - 描述
- `created_at` - 建立時間
- `updated_at` - 更新時間

#### orders（訂單表）
- `id` - 主鍵
- `user_id` - 用戶 ID（外鍵）
- `subtotal` - 小計
- `tax` - 稅額
- `total` - 總計
- `created_at` - 建立時間

#### order_items（訂單項目表）
- `id` - 主鍵
- `order_id` - 訂單 ID（外鍵）
- `product_id` - 商品 ID（外鍵）
- `quantity` - 數量
- `price` - 單價

## 安裝與執行

### 環境需求
- Python 3.7+
- XAMPP（包含 MySQL）
- 現代瀏覽器（Chrome、Firefox、Edge 等）

### 安裝步驟

1. **安裝 Python 套件**
   ```bash
   pip install -r requirements.txt
   ```

2. **啟動 XAMPP**
   - 啟動 Apache 和 MySQL 服務
   - 確認 MySQL 運行在 `localhost:3306`

3. **執行應用程式**
   ```bash
   python main.py
   ```

4. **訪問系統**
   - 開啟瀏覽器訪問：`http://localhost:5000`
   - API 端點：`http://localhost:5000/api`



## API 端點說明

### 認證相關
- `POST /api/auth/register` - 用戶註冊
- `POST /api/auth/login` - 用戶登入
- `POST /api/auth/logout` - 用戶登出
- `GET /api/auth/status` - 檢查登入狀態
- `PUT /api/auth/profile` - 更新個人資料

### 商品相關
- `GET /api/products` - 獲取所有商品
- `GET /api/products/<id>` - 獲取單一商品
- `POST /api/products` - 新增商品（需登入）
- `PUT /api/products/<id>` - 更新商品（需登入）
- `DELETE /api/products/<id>` - 刪除商品（需登入）

### 訂單相關
- `POST /api/orders` - 創建訂單（需登入）
- `GET /api/orders` - 獲取個人訂單（需登入）

### 管理員統計（需管理員權限）
- `GET /api/admin/stats/employee-sales` - 員工銷售統計
- `GET /api/admin/stats/daily-product-sales` - 當日產品銷售統計
- `GET /api/admin/stats/employee-average` - 員工平均銷售統計

## 安全特性

1. **密碼加密**：使用 SHA256 雜湊演算法儲存密碼
2. **Session 管理**：使用 Flask Session 管理用戶狀態
3. **權限控制**：管理員功能僅限管理員角色存取
4. **輸入驗證**：前後端雙重驗證用戶輸入
5. **SQL 注入防護**：使用參數化查詢

## 系統特色

1. **響應式設計**：適配不同螢幕尺寸
2. **即時更新**：購物車、庫存即時同步
3. **交易安全**：使用資料庫事務確保資料一致性
4. **用戶體驗**：直觀的操作介面，清晰的視覺回饋
5. **資料完整性**：外鍵約束確保資料關聯正確

## 專案檔案結構

```
sql demo/
├── index.html          # 前端 HTML 結構
├── index.css           # 前端樣式表
├── index.js            # 前端 JavaScript 邏輯
├── main.py             # Flask 後端應用程式
├── requirements.txt    # Python 依賴套件
└── README.md           # 專案說明文件
```

## 注意事項

1. 首次執行時，系統會自動建立資料庫和資料表
2. 系統會自動建立預設管理員帳號（admin/admin123）
3. 系統會自動建立 5 個範例商品供測試使用
4. 確保 XAMPP 的 MySQL 服務已啟動
5. 預設資料庫名稱為 `pos_system`，可在 `main.py` 中修改

---

